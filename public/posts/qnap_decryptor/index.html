<!DOCTYPE html>
<html><head>
	<meta charset="utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Qnap decryptor module - E-M-B-A The firmware scanning environment</title><meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="EMBA got a new module for decrypting QNAP firmware files." />
	<meta property="og:image" content=""/>
	<meta property="og:title" content="Qnap decryptor module" />
<meta property="og:description" content="EMBA got a new module for decrypting QNAP firmware files." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://e-m-b-a.github.io/posts/qnap_decryptor/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-01-15T16:21:53+01:00" />
<meta property="article:modified_time" content="2022-01-15T16:21:53+01:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Qnap decryptor module"/>
<meta name="twitter:description" content="EMBA got a new module for decrypting QNAP firmware files."/>
<script src="https://e-m-b-a.github.io/js/feather.min.js"></script>
	
	
        <link href="https://e-m-b-a.github.io/css/fonts.b685ac6f654695232de7b82a9143a46f9e049c8e3af3a21d9737b01f4be211d1.css" rel="stylesheet">
	

	
	<link rel="stylesheet" type="text/css" media="screen" href="https://e-m-b-a.github.io/css/main.2f9b5946627215dc1ae7fa5f82bfc9cfcab000329136befeea5733f21e77d68f.css" />
		<link id="darkModeStyle" rel="stylesheet" type="text/css" href="https://e-m-b-a.github.io/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css"   />
	
	
	
</head>
<body>
        <div class="content"><header>
	<div class="main">
		<a href="https://e-m-b-a.github.io/">E-M-B-A The firmware scanning environment</a>
	</div>
	<nav>
		
		
	</nav>
</header>

<main>
	<article>
		<div class="title">
			<h1 class="title">Qnap decryptor module</h1>
			<div class="meta">Posted on Jan 15, 2022 <span class="draft-label">DRAFT</span> </div>
		</div>
		

		<section class="body">
			<p>On my last pentest of a QNAP storage I have seen that EMBA was not able to extract the firmware files. After some digging and research I found out that the firmware update files from the <a href="https://www.qnap.com/de-de/download?model=ts-453bu-rp&amp;category=firmware">download site</a> are encrypted. Binwalk for the rescue was able to give a hint on it:</p>
<p><img src="img/qnap-decrypt-binwalk.png" alt="QNAP decrypt binwalk"></p>
<p>This was the good. The bad is, that binwalk was not able to extract the firmware. This means I started with some recon.
First I found the interesting project <a href="https://github.com/max-boehm/qnap-utils">qnap-utils</a> which should be able to unpack firmware images. In <a href="https://github.com/max-boehm/qnap-utils/issues/1">issue 1</a> the source code of a working version of the needed PC1 tool was linked. After compiling it on my current Kali linux machine I was able to extract a tgz file from the update image.</p>
<p><img src="img/qnap-decrypt.png" alt="QNAP decrypt"></p>

		</section>

		<div class="post-tags">
			
			
			
		</div>
	</article>
</main>
<footer>
<hr><a class="soc" href="https://github.com/e-m-b-a" title="GitHub"><i data-feather="github"></i></a>|<a class="soc" href="https://twitter.com/securefirmware/" title="Twitter"><i data-feather="twitter"></i></a>|</footer>


<script>
      feather.replace()
</script></div>
    </body>
</html>
