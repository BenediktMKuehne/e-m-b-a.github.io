<!doctype html><html><head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge"><title>Qnap decryptor module - EMBARK BEYOND</title><meta name=viewport content="width=device-width,initial-scale=1">
<meta name=description content="EMBA got a new module for decrypting QNAP firmware files.">
<meta property="og:image" content>
<meta property="og:title" content="Qnap decryptor module">
<meta property="og:description" content="EMBA got a new module for decrypting QNAP firmware files.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://e-m-b-a.github.io/posts/qnap_decryptor/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2022-01-15T16:21:53+01:00">
<meta property="article:modified_time" content="2022-01-15T16:21:53+01:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Qnap decryptor module">
<meta name=twitter:description content="EMBA got a new module for decrypting QNAP firmware files.">
<script src=https://e-m-b-a.github.io/js/feather.min.js></script>
<link href=https://e-m-b-a.github.io/css/fonts.b685ac6f654695232de7b82a9143a46f9e049c8e3af3a21d9737b01f4be211d1.css rel=stylesheet>
<link rel=stylesheet type=text/css media=screen href=https://e-m-b-a.github.io/css/main.2f9b5946627215dc1ae7fa5f82bfc9cfcab000329136befeea5733f21e77d68f.css>
<link id=darkModeStyle rel=stylesheet type=text/css href=https://e-m-b-a.github.io/css/dark.726cd11ca6eb7c4f7d48eb420354f814e5c1b94281aaf8fd0511c1319f7f78a4.css>
<link rel=stylesheet type=text/css href=https://e-m-b-a.github.io/css/style.b49edceeedbcb03c821f7357d5ccc562d9faae79fbf02f3f37515404934130dd.css>
</head>
<body>
<div class=content><header>
<a class=main href=https://e-m-b-a.github.io/></a>
<nav>
<a href=/posts/>Blog</a>
<a href=/wiki/emba/>EMBA</a>
<a href=/wiki/embark/>EMBArk</a>
</nav>
</header>
<main>
<article>
<div class=title>
<h1 class=title>Qnap decryptor module</h1>
<div class=meta>Posted on Jan 15, 2022</div>
</div>
<section class=body>
<p>On my last pentest I had a QNAP storage firmware in front of me. After starting EMBA with the default profile I realised that EMBA was not able to extract the needed firmware files. After some digging and research I found that the firmware update files from the <a href="https://www.qnap.com/de-de/download?model=ts-453bu-rp&category=firmware">download site</a> are somehow encrypted. Additionally Binwalk was able to give a hint on it:</p>
<p><img src=/img/qnap-decrypt-binwalk.png alt=QNAP_decrypt_binwalk></p>
<p>This was the good. The bad is, that binwalk was not able to extract the firmware. This means we started with some recon.
First I found the interesting project <a href=https://github.com/max-boehm/qnap-utils>qnap-utils</a> which should be able to unpack firmware images. In <a href=https://github.com/max-boehm/qnap-utils/issues/1>issue 1</a> the source code of a working version of the needed PC1 tool was linked. After compiling it on my current Kali linux machine I was able to extract a tgz file from the update image.</p>
<p><img src=/img/qnap-decrypt.png alt=QNAP_decrypt></p>
</section>
<div class=post-tags>
</div>
</article>
</main>
<footer>
<hr><a class=soc href=https://github.com/e-m-b-a title=GitHub><i data-feather=github></i></a>&nbsp;<a class=soc href=https://twitter.com/securefirmware/ title=Twitter><i data-feather=twitter></i></a>&nbsp;
<div class=tooltip><a class=soc><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-info"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12" y2="8"/></svg></a>
<span class=tooltiptext>Build with Hugo & based on Archie Theme</span>
</div>
</footer>
<script>feather.replace()</script></div>
</body>
</html>